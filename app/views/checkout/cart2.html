<link href="../../styles/checkout/cart.css" rel="stylesheet"/>

<div class="appBody">
  <!-- Google Tag Manager -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5BJDWF"
                    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5BJDWF');</script>
  <!-- End Google Tag Manager -->

  <div class="cartBody" ng-class="{'appBodyOverflow': imageDisplay1 >= 0 }">

    <div data-ng-if="wheelchairs.length === 0">
      <img class="add-icon" data-ng-src="images/my_design_page/cart_empty.png">
      <span class="medium">Your cart is currently empty</span>
    </div>
    <div style="width: 100%;">
      <ul class="media-list" ng-if="wheelchairs.length" style="max-width: 500px;">
        <li ng-repeat="w in wheelchairs" class="media cart-item {{wheelchairUIOpts[$index].checked ? 'checked-item' : ''}}" style="overflow: visible;">
          <!-- Shows Wheelchair Image in canvas on left -->
          <div class="pull-left">
            <div class="media-object">
              <input type="checkbox" class="checkbox-button" ng-model="wheelchairUIOpts[$index].checked">
              <canvas my-canvas img_arr={{w.getPreviewImages(3)}} ng-mouseover="editPanelShow = true"
                  ng-mouseleave="editPanelShow = false"
                  ng-click="toggleImageDisplay($index)"
                  width="{{WHEELCHAIR_CANVAS_WIDTH}}">
              </canvas>
            </div>
          </div>
          <!-- All content related to wheelchair -->
          <div class="media-body" style="overflow: visible;">
            <div>
              <h3>{{w.title}}</h3>
              <img class="trash_icon"
                data-ng-src="images/my_design_page/delete.png"
                width="20"
                ng-click="deleteWheelchair($index)">
            </div>
            <!-- Buttons that edit the wheelchair -->
            <ul style="list-style-type: none; padding:0; margin:0;">
              <li ng-click="editWheelchair($index)"><a>Edit</a></li>
              <li ng-click="moveToWishlist($index)"><a>Move to Wishlist</a></li>
              <li ng-click="duplicateWheelchair($index)"><a>Duplicate</a></li>
            </ul>
            <br>
            <!-- Dropdown -->
            <div>
              <p class="clickable-text {{wheelchairUIOpts[$index].showInfo ? 'dropup' : ''}}" ng-click="wheelchairUIOpts[$index].showInfo = !wheelchairUIOpts[$index].showInfo">{{wheelchairUIOpts[$index].showInfo ? 'LESS' : 'MORE'}} INFO <span class="caret"></span></p>
              <h4 style="float: right;">${{w.getTotalPrice()}}</h4>
            </div>
            <br>

            <!-- Tables showing Part & Measurement configurations -->
            <div style="padding: {{WHEELCHAIR_CANVAS_WIDTH}};">
              <!-- Parts Table...only shown if toggled -->
              <h3 ng-if="wheelchairUIOpts[$index].showInfo">Parts</h3>
              <table ng-if="wheelchairUIOpts[$index].showInfo">
                <tr class="part-row" ng-repeat="part in parts">
                  <td class="title-column">
                    <p data-ng-bind="part.getName()"></p>
                  </td>
                  <td class="value-column">
                    <p data-ng-bind="getPartOption(w, part)"></p>
                  </td>
                </tr>
              </table>
              <br>

              <!-- Measurements Table...only shown if toggled -->
              <h3 ng-if="wheelchairUIOpts[$index].showInfo">Measurements</h3>
              <table ng-if="wheelchairUIOpts[$index].showInfo">
                <tr class="part-row" ng-repeat="measure in getWheelchairMeasures(w)">
                  <td class="title-column">
                    <p data-ng-bind="measure.getName()"></p>
                  </td>
                  <td class="value-column">
                    <p data-ng-bind="getMeasureDetails(w, measure).optionString"></p>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </li>
      </ul>

      <div style="float: left;">
        <div class="pricing-table">
          <table>
            <tr class="part-row">
              <td class="title-column">
                <p>Subtotal</p>
              </td>
              <td class="value-column">
                <p>${{costs.subtotal >= 0 ? costs.subtotal : '--'}}</p>
              </td>
            </tr>
            <tr class="part-row">
              <td class="title-column">
                <p>Shipping Est.</p>
              </td>
              <td class="value-column">
                <p>${{costs.shipping >= 0 ? costs.shipping : '--'}}</p>
              </td>
            </tr>
            <tr class="part-row">
              <td class="title-column">
                <p>Tax</p>
              </td>
              <td class="value-column">
                <p>${{costs.tax >= 0 ? costs.tax : '--'}}</p>
              </td>
            </tr>
            <tr class="part-row">
              <td class="value-column">
                <hr class="pull-right"></hr>
              </td>
            </tr>
            <tr class="part-row">
              <td class="title-column">
                <p><strong>Total</strong></p>
              </td>
              <td class="value-column">
                <p><strong>${{costs.total >= 0 ? costs.total : '--'}}</strong></p>
              </td>
            </tr>
          </table>
        </div>

        <div class="payment-table">
          <p>Choose a payment method</p>
          <div class="apply-form">
            <div class="btn-group">
              <button type="button" class="btn btn-default dropdown-toggle cartpage-dropdown" data-toggle="dropdown">
                Select<span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li>
                  <a ng-click="choosePayment('insurance')">Insurance</a></li>
                <li>
                  <a ng-click="choosePayment('downPayment')">30% down payment</a>
                </li>
                <li>
                  <a ng-click="choosePayment('payFull')">Pay in full</a>
                </li>
              </ul>
            </div>
            <button type="button" class="btn btn-default apply-button pull-right" ng-click="applyPaymentMethod()">Apply</button>
          </div>
        </div>

        <div class="zipcode-area">
          <p>Enter zip code to estimate shipping cost</p>
          <div class="apply-form">
            <input type="number" placeholder="Enter zipcode" class="zipcode-input" ng-model="zipcode"></input>
            <button type="button" class="btn btn-default pull-right {{zipcode === curOrder.zip ? 'apply-button' : 'invalidated-apply-button'}}" ng-click="applyZipcode()">Apply</button>
          </div>
        </div>

        <div>
          <button type="button" class="btn btn-default checkoutButton" ng-click="checkOut()">Checkout</button>
        </div>
      </div>
    </div>

  </div>


  <!-- Shows wheelchair on Modal Dialog if small canvas is clicked -->
  <div ng-repeat="w in wheelchairs" ng-if="imageDisplay1 == $index" id="displayImage">
    <div id="offClickArea" ng-show="imageDisplay1 >= 0" data-ng-click="toggleImageDisplay(-1)"></div>
    <div class="mainDisplay">
      <div id="designTitle"><h3 data-ng-bind="w.getTitle()"></h3></div>
      <img class="leftButton" src="images/icons/left_button.svg" alt="Previous" width="30" height="30"
           ng-show="wheelchairs.length > 1"
           data-ng-click="rotate(-1)"/>
      <img class="rightButton" src="images/icons/right_button.svg" alt="Next" width="30" height="30"
           ng-show="wheelchairs.length > 1"
           data-ng-click="rotate(1)"/>
      <canvas my-canvas img_arr="{{w.getPreviewImages(3)}}"
              width="518" height="400"></canvas>
    </div>
  </div>

</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64294275-1', 'auto');
  ga('send', 'pageview');

</script>
